# ğŸ¤– è‡ªåŠ¨å‘å¸ƒåˆ° npm é…ç½®æŒ‡å—

## ğŸ“‹ é…ç½®æ­¥éª¤

### 1ï¸âƒ£ è·å– npm Token

```bash
# ç™»å½• npm
npm login

# ç”Ÿæˆè®¿é—®ä»¤ç‰Œ
# æ–¹æ³•ä¸€ï¼šé€šè¿‡å‘½ä»¤è¡Œ
npm token create

# æ–¹æ³•äºŒï¼šé€šè¿‡ç½‘é¡µ
# è®¿é—® https://www.npmjs.com/settings/[ä½ çš„ç”¨æˆ·å]/tokens
# ç‚¹å‡» "Generate New Token" â†’ é€‰æ‹© "Automation" ç±»å‹
```

**é‡è¦ï¼š** å¤åˆ¶ç”Ÿæˆçš„ tokenï¼Œå®ƒåªä¼šæ˜¾ç¤ºä¸€æ¬¡ï¼

---

### 2ï¸âƒ£ åœ¨ GitHub è®¾ç½® Secret

1. æ‰“å¼€ä½ çš„ GitHub ä»“åº“ï¼šhttps://github.com/wuhaoyue/wj-waterfall-flow
2. è¿›å…¥ **Settings** â†’ **Secrets and variables** â†’ **Actions**
3. ç‚¹å‡» **New repository secret**
4. å¡«å†™ä¿¡æ¯ï¼š
   - **Name**: `NPM_TOKEN`
   - **Secret**: ç²˜è´´åˆšæ‰å¤åˆ¶çš„ npm token
5. ç‚¹å‡» **Add secret**

---

### 3ï¸âƒ£ æ¨é€ä»£ç å’Œå·¥ä½œæµ

```bash
# æäº¤å·¥ä½œæµæ–‡ä»¶
git add .github/workflows/publish.yml
git commit -m "ci: æ·»åŠ è‡ªåŠ¨å‘å¸ƒåˆ° npm çš„ GitHub Actions"

# æ¨é€åˆ° GitHub
git push origin main
```

---

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### æ–¹å¼ä¸€ï¼šé€šè¿‡ npm version å‘½ä»¤ï¼ˆæ¨èï¼‰

```bash
# 1. ä¿®æ”¹ä»£ç åï¼Œæ›´æ–°ç‰ˆæœ¬å·å¹¶è‡ªåŠ¨åˆ›å»º tag
npm version patch   # 1.0.0 -> 1.0.1 (bug ä¿®å¤)
npm version minor   # 1.0.0 -> 1.1.0 (æ–°åŠŸèƒ½)
npm version major   # 1.0.0 -> 2.0.0 (ç ´åæ€§å˜æ›´)

# 2. æ¨é€ä»£ç å’Œ tag
git push --follow-tags

# âœ¨ GitHub Actions ä¼šè‡ªåŠ¨ï¼š
#    - å®‰è£…ä¾èµ–
#    - ç±»å‹æ£€æŸ¥
#    - æ„å»ºé¡¹ç›®
#    - å‘å¸ƒåˆ° npm
```

### æ–¹å¼äºŒï¼šæ‰‹åŠ¨åˆ›å»º tag

```bash
# 1. åˆ›å»º tag
git tag v1.0.1

# 2. æ¨é€ tag
git push origin v1.0.1

# âœ¨ è‡ªåŠ¨è§¦å‘å‘å¸ƒ
```

---

## ğŸ“ å®Œæ•´å·¥ä½œæµç¨‹ç¤ºä¾‹

```bash
# 1. ä¿®æ”¹ä»£ç 
# ... ç¼–å†™ä»£ç  ...

# 2. æäº¤æ›´æ”¹
git add .
git commit -m "feat: æ·»åŠ æ–°åŠŸèƒ½"

# 3. æ›´æ–°ç‰ˆæœ¬å·ï¼ˆè‡ªåŠ¨åˆ›å»º git tagï¼‰
npm version minor

# 4. æ¨é€åˆ° GitHubï¼ˆåŒ…æ‹¬ tagï¼‰
git push --follow-tags

# 5. ç­‰å¾…è‡ªåŠ¨å‘å¸ƒ
# è®¿é—® https://github.com/wuhaoyue/wj-waterfall-flow/actions
# æŸ¥çœ‹å‘å¸ƒçŠ¶æ€
```

---

## ğŸ” æŸ¥çœ‹å‘å¸ƒçŠ¶æ€

1. è®¿é—® GitHub Actions é¡µé¢ï¼š
   https://github.com/wuhaoyue/wj-waterfall-flow/actions

2. æŸ¥çœ‹æœ€æ–°çš„ workflow è¿è¡ŒçŠ¶æ€

3. å¦‚æœå¤±è´¥ï¼Œç‚¹å‡»æŸ¥çœ‹è¯¦ç»†æ—¥å¿—

---

## âš™ï¸ å·¥ä½œæµè¯´æ˜

### è§¦å‘æ¡ä»¶
- æ¨é€ä»¥ `v` å¼€å¤´çš„ tagï¼ˆå¦‚ `v1.0.0`ã€`v2.1.3`ï¼‰

### æ‰§è¡Œæ­¥éª¤
1. âœ… æ£€å‡ºä»£ç 
2. âœ… è®¾ç½® Node.js ç¯å¢ƒ
3. âœ… å®‰è£…ä¾èµ–
4. âœ… TypeScript ç±»å‹æ£€æŸ¥
5. âœ… æ„å»ºé¡¹ç›®
6. âœ… å‘å¸ƒåˆ° npm

### ç¯å¢ƒå˜é‡
- `NODE_AUTH_TOKEN`: ä» GitHub Secrets ä¸­è¯»å–çš„ npm token

---

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. ç‰ˆæœ¬å·è§„èŒƒ

éµå¾ªè¯­ä¹‰åŒ–ç‰ˆæœ¬ï¼ˆSemantic Versioningï¼‰ï¼š

- **1.0.0** â†’ **1.0.1**: ä¿®å¤ bugï¼ˆpatchï¼‰
- **1.0.0** â†’ **1.1.0**: æ–°å¢åŠŸèƒ½ï¼ˆminorï¼‰
- **1.0.0** â†’ **2.0.0**: ç ´åæ€§å˜æ›´ï¼ˆmajorï¼‰

### 2. æäº¤ä¿¡æ¯è§„èŒƒ

```bash
feat: æ–°åŠŸèƒ½
fix: bug ä¿®å¤
docs: æ–‡æ¡£æ›´æ–°
style: ä»£ç æ ¼å¼åŒ–
refactor: é‡æ„
perf: æ€§èƒ½ä¼˜åŒ–
test: æµ‹è¯•
chore: æ„å»º/å·¥å…·å˜åŠ¨
```

### 3. å‘å¸ƒå‰æ£€æŸ¥

```bash
# æœ¬åœ°æµ‹è¯•
npm run type-check  # ç±»å‹æ£€æŸ¥
npm run build       # æ„å»º
npm run dev         # æµ‹è¯•åŠŸèƒ½

# ç¡®è®¤ä¸€åˆ‡æ­£å¸¸åå†å‘å¸ƒç‰ˆæœ¬
```

---

## ğŸ”§ è‡ªå®šä¹‰é…ç½®

### ä¿®æ”¹è§¦å‘æ¡ä»¶

ç¼–è¾‘ `.github/workflows/publish.yml`:

```yaml
# åªåœ¨ç‰¹å®šåˆ†æ”¯å‘å¸ƒ
on:
  push:
    branches:
      - main
    tags:
      - 'v*'

# æˆ–è€…æ‰‹åŠ¨è§¦å‘
on:
  workflow_dispatch:
```

### æ·»åŠ æ›´å¤šæ£€æŸ¥

```yaml
- name: Run tests
  run: npm test

- name: Lint check
  run: npm run lint
```

---

## âŒ å¸¸è§é—®é¢˜

### Q1: å‘å¸ƒå¤±è´¥ï¼Œæç¤º "ENEEDAUTH"ï¼Ÿ

**A**: NPM_TOKEN æœªæ­£ç¡®é…ç½®æˆ–å·²è¿‡æœŸ
- é‡æ–°ç”Ÿæˆ token
- æ›´æ–° GitHub Secret

### Q2: tag æ¨é€äº†ä½†æ²¡æœ‰è§¦å‘å‘å¸ƒï¼Ÿ

**A**: æ£€æŸ¥ tag æ ¼å¼
- å¿…é¡»ä»¥ `v` å¼€å¤´ï¼Œå¦‚ `v1.0.0`
- ä¸èƒ½æ˜¯ `1.0.0` æˆ– `version-1.0.0`

### Q3: å¦‚ä½•æŸ¥çœ‹å‘å¸ƒæ—¥å¿—ï¼Ÿ

**A**: 
1. è¿›å…¥ GitHub ä»“åº“
2. ç‚¹å‡» "Actions" æ ‡ç­¾
3. é€‰æ‹©å¯¹åº”çš„ workflow è¿è¡Œè®°å½•
4. æŸ¥çœ‹è¯¦ç»†æ—¥å¿—

---

## ğŸ‰ é…ç½®å®Œæˆï¼

ç°åœ¨ä½ å¯ä»¥é€šè¿‡ç®€å•çš„å‘½ä»¤å‘å¸ƒæ–°ç‰ˆæœ¬ï¼š

```bash
npm version patch && git push --follow-tags
```

GitHub Actions ä¼šè‡ªåŠ¨å®Œæˆå‰©ä¸‹çš„å·¥ä½œï¼ğŸš€

